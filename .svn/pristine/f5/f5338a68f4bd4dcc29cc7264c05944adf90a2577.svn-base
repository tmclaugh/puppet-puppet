# $Id$

<Location /<%= path %>>
<% if not restriction %>
	DAV svn
	SVNPath <%= svn_root %>/<%= path %>
<% end %>
<% if sslonly %>
	# Require SSL connection for password protection.
	SSLRequireSSL
<% end %>
	AuthType Basic
	AuthName "<%= description %>"
	AuthBasicProvider ldap
	# This should be TLS below.
	AuthLDAPUrl ldap://<%= ldap %>:389/CN=Users,<%= ldap_base %>?sAMAccountName
	AuthLDAPBindDN <%= ldap_binddn %>
	AuthLDAPBindPassword <%= ldap_bindpw %>
<% if private %>
	<Limit GET PROPFIND OPTIONS REPORT>
		Require valid-user
<% if svn_authz_read %>
		Require ldap-group CN=<%= svn_authz_read %>,<%= ldap_base_users %>
<% else %>
		Require ldap-group CN=<%= svn_authz %>,<%= ldap_base_users %>
<% end %>
	</Limit>
	<LimitExcept GET PROPFIND OPTIONS REPORT>
		Require valid-user
		Require ldap-group CN=<%= svn_authz %>,<%= ldap_base_users %>
	</LimitExcept>
<% else %>
	<LimitExcept GET PROPFIND OPTIONS REPORT>
		Require valid-user
<% if svn_authz %>		Require ldap-group CN=<%= svn_authz %>,<%= ldap_base_users %><% end %>
	</LimitExcept>
<% end %>
</Location>

<Location /viewvc/<%= path %>>
<% if sslonly %>
	# Require SSL connection for password protection.
	SSLRequireSSL
<% end %>
	AuthType Basic
	AuthName "<%= description %>"
	AuthBasicProvider ldap
	# This should be TLS below.
	AuthLDAPUrl ldap://<%= ldap %>:389/CN=Users,<%= ldap_base %>?sAMAccountName
	AuthLDAPBindDN <%= ldap_binddn %>
	AuthLDAPBindPassword <%= ldap_bindpw %>
<% if private %>
	<Limit GET PROPFIND OPTIONS REPORT>
		Require valid-user
<% if svn_authz_read %>
		Require ldap-group CN=<%= svn_authz_read %>,<%= ldap_base_users %>
<% else %>
		Require ldap-group CN=<%= svn_authz %>,<%= ldap_base_users %>
<% end %>
	</Limit>
	<LimitExcept GET PROPFIND OPTIONS REPORT>
		Require valid-user
		Require ldap-group CN=<%= svn_authz %>,<%= ldap_base_users %>
	</LimitExcept>
<% else %>
	<LimitExcept GET PROPFIND OPTIONS REPORT>
		Require valid-user
<% if svn_authz %>		Require ldap-group CN=<%= svn_authz %>,<%= ldap_base_users %><% end %>
	</LimitExcept>
<% end %>
</Location>

