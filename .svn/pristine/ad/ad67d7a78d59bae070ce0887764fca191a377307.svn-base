# $Id$

class apache::proxy {
	file { "/etc/httpd/proxy.d" :
		ensure => directory,
		require => Package["httpd"],
	}
	
	file { "/etc/httpd/conf.d/proxy.conf" :
		owner => root,
		group => root,
		mode => 644,
		source => "puppet:///modules/apache/proxy.conf",
		require => Package["httpd"],
		notify => Service["httpd_service"],
	}

}

define apache::proxy::site ($intname,
							$ssl=true,
							$nonssl=true,
							$sslcert,
							$sslkey,
							$sslchain,
							$ip,
							$rewriterule=false,
							$rewritecond=false,
							$rewriterulessl=false,
							$rewritecondssl=false,
							$options=false,
							$optionsssl=false,
							$restrictions=false,
							$ensure="present") {
	file { "/etc/httpd/proxy.d/${name}.conf" :
		ensure => $ensure,
		owner => root,
		group => root,
		mode => 644,
		content => template("apache/proxy.conf.erb"),
		require => File["/etc/httpd/conf.d/proxy.conf"],
		notify => Service["httpd_service"]
	}
}
